# UML 建模 ATM自助取款机

### 需求分析

- 用户将银行卡插入读卡器，读卡器识别银行卡的真伪，并在屏幕上提示输入密码
- 用户通过键盘输入密码，系统验证密码是否有效，如果有效则提示客户进行选择要操作的义务
- 用户根据自己的需要可以进行存款、转账、取款修改密码、查询账户等选择操作
- 在用户选择后显示器进行交互提示和操作确认消息等
- 操作完成后用户退卡
- 维护人员对ATM机进行加钞、加凭条纸、维护、维修等工作
- 数据管理员管理用户信息

需要创建的结构类图：

类图（ATM自助取款机、客户、维护人员、管理员、读卡器、屏幕显示、键盘、取钱机、数据库）、ATM系统构件图、ATM系统部署图

需要创建的行为类图：

用户用例图、维修人员用例图、数据管理员用例图、用户使用ATM机的活动图、ATM机的状态图、取钱功能顺序图、存款功能顺序图、转账功能顺序图、取钱功能通信图、存钱通信图、转账通信图

### UML 图建模

#### 用例图

用例图是指由参与者、用例以及它们之间的关系构成的用于描述系统功能的静态视图。用例图是被称为参与者的外部用户所能观察到的系统功能的模型图，呈现了一些参与者和一些用例，以及它们之间的关系，主要用于对系统、子系统或类的功能行为进行建模。

##### 客户用例图

![客户用例图.drawio](https://pig-1307013046.cos.ap-nanjing.myqcloud.com/PigCo/%E5%AE%A2%E6%88%B7%E7%94%A8%E4%BE%8B%E5%9B%BE.drawio.png)

用户的操作有存款、取款、验证、查询余额、修改密码、资金转账，其中有关修改密码以及涉及资金的操作的步骤均需要验证操作

ATM机与打印交易凭条、验证和资金转账直接关联

##### 维护人员用例图

![维护人员用例图.drawio](https://pig-1307013046.cos.ap-nanjing.myqcloud.com/PigCo/%E7%BB%B4%E6%8A%A4%E4%BA%BA%E5%91%98%E7%94%A8%E4%BE%8B%E5%9B%BE.drawio.png)

维护人员分为ATM机公司维护人员和ATM机维护人员。其中ATM维护人员负责简单的日常维护、加凭条纸、加钞等操作，遇到严重问题时向公司维护人员报告，ATM机公司维护主要负责严重问题处理、定期检修和安装ATM机

##### 数据管理员用例图

![数据管理员用例图.drawio](https://pig-1307013046.cos.ap-nanjing.myqcloud.com/PigCo/%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86%E5%91%98%E7%94%A8%E4%BE%8B%E5%9B%BE.drawio.png)

#### 类图

类图(Class diagram)由许多（静态）说明性的模型元素组成。类图可以组织在包中，仅显示特定包中的相关内容。类图是最常用的UML图，显示出类、接口以及它们之间的静态结构和关系；它用于描述系统的结构化设计。类图最基本的元素是类或者接口。

![类图.drawio](https://pig-1307013046.cos.ap-nanjing.myqcloud.com/PigCo/%E7%B1%BB%E5%9B%BE.drawio.png)

对于账户类，其有私有变量客户号码，数据类型为 string

拥有 4 个public的操作

- 查询余额，没有输入，输出为账户余额（float）
- 取款，输入为需要取的金额
- 修改密码存款
- 转账，输入为金额和对方账户

账户类使用数据库连接类、使用信息类和用户实例，被取钱机类、ATM自动取款机类、屏幕类、读卡器类关联

#### 活动图

活动图是一种用于描述系统行为的模型视图，它可用来描述动作和动作导致对象状态改变的结果，而不用考虑引发状态改变的事件。通常，活动图记录单个操作或方法的逻辑、单个用例或商业过程的逻辑流程

![活动图.drawio](https://pig-1307013046.cos.ap-nanjing.myqcloud.com/PigCo/%E6%B4%BB%E5%8A%A8%E5%9B%BE.drawio.png)

整个流程从客户插入IC卡开始，输入密码；银行系统验证密码，若无效则重新输入，若有效，客户开始选择业务，分为存款、取款、转账三个功能

**对于存款：**

客户放入钞票，ATM机进行验钞；若为真，银行系统把该客户的账户金额增加；若为假，ATM吐出钞票，由客户取走

**对于取款：**

客户输入取款金额，由银行系统验证金额；若为真银行系统扣除相应的扣除金额，ATM出钞，客户取走chaopiao

**对于转账：**

客户输入对方的账号和转账金额，由银行系统验证账号和金额；若合法，银行系统扣除本账户添加对方账户

完成操作后，ATM机退卡，客户取走银行卡，结束流程

#### 时序图

时序图，又名序列图、循序图，是一种UML交互图。它通过描述对象之间发送消息的时间顺序显示多个对象之间的动态协作。

##### 取钱时序图

![取钱时序图.drawio](https://pig-1307013046.cos.ap-nanjing.myqcloud.com/PigCo/%E5%8F%96%E9%92%B1%E6%97%B6%E5%BA%8F%E5%9B%BE.drawio.png)

对于取钱的流程为：

1. 由客户插入卡片到读卡机
2. 读卡机读卡
3. 读卡机初始化ATM机屏幕
4. 读卡机打开银行账户
5. ATM屏幕提示用户输入密码
6. 用户输入密码，并显示在ATM屏幕上
7. ATM屏幕把用户输入的密码传到银行账户，验证密码的正确性
8. ATM屏幕提示用户选择事务
9. 用户选择取现事务
10. ATM屏幕提示输入金额
11. 用户输入金额
12. ATM向银行账户提交
13. 银行账户进行验证
14. 银行账户对该账户扣钱
15. 银行账户提供数据给取款机
16. 取款机验钞并出钞
17. 用户取钱
18. 读卡机退卡

##### 存款时序图

![存款时序图.drawio](https://pig-1307013046.cos.ap-nanjing.myqcloud.com/PigCo/%E5%AD%98%E6%AC%BE%E6%97%B6%E5%BA%8F%E5%9B%BE.drawio.png)

参照取款时序图，按照图中的序号步骤完成流程

##### 转账时序图

![转账时序图.drawio](https://pig-1307013046.cos.ap-nanjing.myqcloud.com/PigCo/%E8%BD%AC%E8%B4%A6%E6%97%B6%E5%BA%8F%E5%9B%BE.drawio.png)

参照取款时序图，按照图中的序号步骤完成流程



#### 状态图

状态图(Statechart Diagram)是描述一个实体基于事件反应的动态行为，显示了该实体如何根据当前所处的状态对不同的事件做出反应的。通常我们创建一个UML状态图是为了以下的研究目的：研究类、角色、子系统、或组件的复杂行为。

![状态凸.drawio](https://pig-1307013046.cos.ap-nanjing.myqcloud.com/PigCo/%E7%8A%B6%E6%80%81%E5%9B%BE.drawio.png)

#### 协作图

协作图用于显示对象之间如何进行交互以执行特定用例或用例中特定部分的行为。设计员使用协作图和序列图确定并阐明对象的角色，这些对象执行用例的特定事件流。它们是主要的信息来源，用于确定类的职责和接口。

##### 取钱协作图

![取钱.drawio](https://pig-1307013046.cos.ap-nanjing.myqcloud.com/PigCo/%E5%8F%96%E9%92%B1.drawio.png)



##### 存钱协作图

![存钱.drawio](https://pig-1307013046.cos.ap-nanjing.myqcloud.com/PigCo/%E5%AD%98%E9%92%B1.drawio.png)

##### 转账协作图

![转账.drawio](https://pig-1307013046.cos.ap-nanjing.myqcloud.com/PigCo/%E8%BD%AC%E8%B4%A6.drawio.png)

***

#### 组件图

组件是代码的实际物理模块，系统的组件图用来显示代码模块间的关系。可以说组件就是一个实际的文件，有三种类型：源代码组件、二进制组件和可执行组件。组件图是物理的、可替换的，它是系统的一部分。

![组件图.drawio](https://pig-1307013046.cos.ap-nanjing.myqcloud.com/PigCo/%E7%BB%84%E4%BB%B6%E5%9B%BE.drawio.png)

主系统包含了数据库服务器、数据服务器、维护人员、读卡器、数据管理员等组件。

#### 部署图

部署图用来描述系统硬件的物理拓扑结构以及在此结构上执行的软件。它可以清醒的描绘硬件设备的配置、通信以及在各设备上的对象和配置。在部署图中，一个节点表示一个物理设备以及在其上运行的软件系统。
其组成元素有

- 进程，即在自己的内存空间执行的线程
- 处理器，即任何有处理功能的机器
- 设备，即任何没有处理功能的机器

![部署图.drawio](https://pig-1307013046.cos.ap-nanjing.myqcloud.com/PigCo/%E9%83%A8%E7%BD%B2%E5%9B%BE.drawio.png)

银行数据库服务器与地区ATM服务器通过专用网连接，地区ATM服务器拥有日志文件等组件并与打印机相连接，地区ATM区分在A、B、C地区部署